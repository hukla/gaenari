<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 다수의 xml 문서 자체를 구분하기 위한 xml 문서 별칭 -->
<mapper namespace="u">


	
	<!-- 14-05-20 성훈수정: 로그인 아이디만 보내도록 수정 -->
	<select id="getOneLoginUser" parameterType="String" resultType="UserDTO" >
		select * from userinfo where userid = #{userid}
	</select>
	
	<!-- 2014-05-24 재희 수정: userno를 가지고 user 불러오기 -->
	<select id="selectOne" parameterType="int" resultType="UserDTO">
		SELECT * FROM userinfo WHERE userno = #{userno}
	</select>
	
	<!-- 2014-05-28 성훈추가: 페이스북으로 받은 email로 user 불러오기 -->
	<select id="getEmailCheck" parameterType="string" resultType="UserDTO">
		SELECT * FROM userinfo WHERE email = #{email}
	</select>
	
	<!-- 2014-05-28 재희 추가: point 더하기 -->
	<update id="updatePoint" parameterType="model.dto.DonReqDTO">
		UPDATE userinfo SET point = point + #{price}*0.05 WHERE userno=#{userno}
	</update>
	
	<!-- 2014-05-29 성훈추가: 이름으로 user정보얻어 dogDTO로 담아보내기 -->
	<select id="getUserByname" parameterType="String" resultType="DogDTO" >
		SELECT username,userid,dogname,dogkind,address FROM userinfo u JOIN dog d 
		ON u.userno = d.userno AND username LIKE '%'||#{username}||'%'
	</select>
	
	<!-- 2014-05-29 성훈추가: 주소로 user정보얻어 dogDTO로 담아보내기 -->
	<select id="getUserByAddr" parameterType="String" resultType="DogDTO" >
		SELECT username,userid,dogname,dogkind,address FROM userinfo u JOIN dog d 
		ON u.userno = d.userno AND address LIKE '%'||#{address}||'%'
	</select>
	
	<!-- 2014-05-29 성훈추가: ID로 user정보얻어 dogDTO로 담아보내기 -->
	<select id="getUserById" parameterType="String" resultType="DogDTO" >
		SELECT u.username,u.userid,d.dogname,d.dogkind,u.address FROM userinfo u JOIN dog d 
		ON u.userno = d.userno AND u.userid=#{userid}
	</select>
	
	<!-- 2014-05-30 성훈추가: 이름으로 user검색하기(강아지 정보 없을 때) -->
	<select id="checkByName" parameterType="String" resultType="UserDTO" >
		select * from userinfo where username = #{username}
	</select>
	
	<!-- 2014-05-30 성훈추가: 주소로 user검색하기(강아지 정보 없을 때) -->
	<select id="checkByAddr" parameterType="String" resultType="UserDTO" >
		select * from userinfo where address = #{address}
	</select>
	
</mapper>					